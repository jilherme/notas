%Este trabalho está licenciado sob a Licença Atribuição-CompartilhaIgual 4.0 Internacional Creative Commons. Para visualizar uma cópia desta licença, visite http://creativecommons.org/licenses/by-sa/4.0/deed.pt_BR ou mande uma carta para Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.

\chapter{EDO de primeira ordem}\label{cap_edo1ordem}
\thispagestyle{fancy}

\section{Equações lineares}\label{cap_edo1ordem_sec_eqlinear}

A forma geral de uma \emph{EDO linear de primeira ordem} é
\begin{equation}
  P(t)\frac{dy}{dt} + Q(t)y = G(t),
\end{equation}
onde $P(t) \neq 0$, $Q(t)$ e $G(t)$ são funções de $t$. Esta pode ser reescrita na forma
\begin{equation}
  \color{blue}{\frac{dy}{dt} + p(t)y = g(t)},
\end{equation}
escolhendo $p(t) = Q(t)/P(t)$ e $g(t) = G(t)/P(t)$.

\subsection{EDO autônoma e homogênea}

Primeiramente, vamos considerar o caso em que $p(t) \equiv a \neq 0$ (constante) e $g(t) \equiv 0$, i.e.
\begin{equation}\label{eq:edo1linear_pc_g0}
  \color{blue}{\frac{dy}{dt} + ay = 0.}
\end{equation}
Podemos reescrever esta equação da seguinte forma
\begin{align}
  \frac{dy}{dt} = -ay &\Rightarrow \frac{1}{y}\frac{dy}{dt} = -a \\
                     &\Rightarrow \frac{1}{y}\,dy = -a\,dt.
\end{align}
Agora, integrando, obtemos
\begin{align}
  \int \frac{1}{y}\,dy = -\int a\,dt &\Rightarrow \ln|y| = -at + c \\
                                    &\Rightarrow e^{\ln|y|} = e^{-at + c} \\
                                    &\Rightarrow e^{\ln|y|} = e^{-at}e^c \\
                                    &\Rightarrow y = ce^{-at},
\end{align}
onde $c$ é uma constante indeterminada.

Com isso, temos que
\begin{equation}
  \color{blue}{y(t) = ce^{-at}}
\end{equation}
é \emph{solução geral} da equação \eqref{eq:edo1linear_pc_g0}.

\begin{ex}
  Vamos resolver o seguinte Problema de Valor Inicial (PVI)
  \begin{align}
    y' - y = 0, \quad t>0,
    y(0) = 1.
  \end{align}
  
  Começamos calculando a solução geral da EDO:
  \begin{align}
    y' = y &\Rightarrow \frac{1}{y}\frac{dy}{dt} = 1 \\
            &\Rightarrow \int \frac{1}{y}\,\frac{dy} = \int 1\,dt \\
            &\Rightarrow \ln|y| = t + c \\
            &\Rightarrow e^{\ln|y|} = e^{t+c}\\
            &\Rightarrow y(t) = ce^{t}.\\
  \end{align}
  Por fim, aplicando a condição inicial, obtemos
  \begin{align}
    y(0) = 1 &\Rightarrow ce^{0} = 1 \\
             &\Rightarrow c = 1.
  \end{align}
  Concluímos que a solução do PVI é
  \begin{equation}
    y(t) = e^{t}.
  \end{equation}
\end{ex}

\subsection{Método dos fatores integrantes}

Vejamos, agora, o caso de uma EDO da forma
\begin{equation}\label{eq:edo1linear_pa_g}
  \color{blue}{\frac{dy}{dt} + ay = g(t).}
\end{equation}

O \emph{método dos fatores integrantes} consiste em multiplicarmos a equação por uma função $\mu = \mu(t)$ (fator integrante) de forma que
\begin{equation}
  \color{blue}{\mu\frac{dy}{dt} + \mu ay = \frac{d}{dt}\left(\mu y\right).}
\end{equation}
Pela regra do produto para derivada, temos que
\begin{equation}
  \mu\frac{dy}{dt} + \mu ay = \mu\frac{dy}{dt} + \mu'y.
\end{equation}
Ou seja, tal função $\mu$ deve satisfazer a seguinte EDO
\begin{equation}
  \color{blue}{\mu' = a\mu.}
\end{equation}
Usando o mesmo procedimento utilizado para \eqref{eq:edo1linear_pc_g0}, obtemos que
\begin{equation}
  \mu(t) = ce^{at}.
\end{equation}
Observamos que qualquer escolha de $c\neq 0$ é apropriada e, por simplicidade, escolhemos $c=1$. Ou seja, escolhemos o fator integrante
\begin{equation}
  \color{blue}{\mu(t) = e^{at}}.
\end{equation}

Agora, retornamos a equação \eqref{eq:edo1linear_pa_g}. Multiplicando-a pelo fator integrante $\mu(t) = e^{at}$, obtemos
\begin{align}
  \mu\frac{dy}{dt} + \mu a y = \mu g(t) &\Rightarrow \frac{d}{dt}\left(\mu y\right) = \mu g(t) \\
                                        &\Rightarrow \int \,d(\mu y) = \int \mu g(t)\,dt \\
                                        &\Rightarrow \mu y = \int \mu g(t)\,dt + c \\
                                        &\Rightarrow y = \frac{1}{\mu}\left[\int \mu g(t)\,dt + c\right]. \\
\end{align}
Portanto, concluímos que
\begin{equation}
  \color{blue}{y(t) = e^{-at}\left[\int g(t)e^{at}\,dt + c\right]}
\end{equation}
é a \emph{solução geral} de \eqref{eq:edo1linear_pa_g}.

\begin{ex}
  Vamos calcular a solução geral da seguinte EDO
  \begin{equation}\label{eq:exer_edo1linear_1}
    y' - y = 1. 
  \end{equation}
  Aplicando o método dos fatores integrantes, temos
  \begin{align}
    \mu y' - \mu y &= (\mu y)' \\
                   &= \mu' y + \mu y'.
  \end{align}
  Ou seja, devemos escolher $\mu$ tal que
  \begin{align}
    \mu' = -\mu &\Rightarrow \frac{1}{\mu}\frac{d\mu}{dt} = -1 \\
                &\Rightarrow \int \frac{1}{\mu}\,d\mu = -\int 1\,d\mu \\
                &\Rightarrow \ln|\mu| = -t + c \\
                &\Rightarrow \mu = ce^{-t}.
  \end{align}
  Por simplicidade, escolhemos $\mu = e^{-t}$.

  Com isso, a EDO \eqref{eq:exer_edo1linear_1} pode ser reescrita como
  \begin{equation}
    \frac{d}{dt}\left(\mu y\right) = \mu\cdot 1 \Rightarrow \frac{d}{dt}\left(e^{-t}y\right) = e^{-t}.
  \end{equation}
  Integrando, obtemos
  \begin{align}
    e^{-t}y = \int e^{-t}\,dt &\Rightarrow e^{-t}y(t) = -e^{-t} + c \\
                              &\Rightarrow y(t) = -e^te^{-t} + ce^{t} \\
                              &\Rightarrow y(t) =  -1 + ce^{t},
  \end{align}
  a qual é a solução geral.
\end{ex}

\subsection{Caso geral}

O caso geral de uma EDO linear de primeira ordem
\begin{equation}\label{eq:edo1linear_pg}
  \color{blue}{y' + p(t)y = g(t)}
\end{equation}
também pode ser resolvido pelo \emph{método dos fatores integrantes}. Neste caso, o fator integrante $\mu = \mu(t)$ deve ser escolhido de forma que
\begin{align}
  \mu y' + \mu p(t) y &= (\mu y)' \\
                      &= \mu' y + \mu y',
\end{align}
ou seja
\begin{equation}
  \mu' = p(t)\mu.
\end{equation}
Integrando, obtemos o \emph{fator integrante}
\begin{equation}
  \color{blue}{\mu(t) = e^{\int p(t)\,dt}.}
\end{equation}

Usando este fator integrante, a equação \eqref{eq:edo1linear_pg} pode ser reescrita da seguinte maneira
\begin{equation}
  \frac{d}{dt}\left(\mu y\right) = \mu g(t).
\end{equation}
Integrando, obtemos a \emph{solução geral}
\begin{equation}
  \color{blue}{y(t) = \frac{1}{\mu(t)}\left[\int \mu(t) g(t)\,dt + c\right].}
\end{equation}

\begin{ex}
  Vamos calcular a solução geral da seguinte EDO
  \begin{equation}\label{ex:edo1linear_geral}
    y' + \frac{1}{t}y = t.
  \end{equation}

  Primeiramente, calculamos o fator integrante $\mu = \mu(t)$ tal que
  \begin{equation}
    \mu y' + \mu \frac{1}{t} y = (\mu y)' = \mu'y + \mu y'.
  \end{equation}
  Ou seja, precisamos que
  \begin{equation}
    \mu' = \frac{1}{t}\mu.
  \end{equation}
  Integrando, obtemos
  \begin{align}
    \mu(t) &= e^{\int \frac{1}{t}\,dt} \\
           &= e^{\ln|t|} \\
           &= t.
  \end{align}

  Aplicando o fator integrante a EDO \eqref{ex:edo1linear_geral}, obtemos
  \begin{align}
    \frac{d}{dt}\left(t y\right) = t^2 &\Rightarrow ty = \int t^2\,dt \\
                                       &\Rightarrow y = \frac{1}{t}\left[\frac{t^3}{3} + c\right] \\
                                       &\Rightarrow y = \frac{t^2}{3} + \frac{c}{t}.
  \end{align}
\end{ex}

\subsection{Aplicação em modelagem}

\begin{ex}\normalfont{(Mistura em tanque)}
  No instante inicial $t=0$~s (segundo), um tanque contem $q_0$~kg (quilograma) de sal dissolvido em $l$~L (litro) de água. Uma solução de $s$~kg/L de sal e água entra no tanque a uma taxa de $r$~L/s. Esta solução mistura-se com o líquido presente no tanque e a mistura final sai do tanque a mesma taxa de $r$~L/s.

  Vamos modelar a quantidade de sal $q$~kg presente no tanque a cada instante $t$~s. Temos que $q$ é função do tempo $t$~s, i.e. $q = q(t)$. A condição inicial é
  \begin{equation}
    q(0) = q_0.
  \end{equation}
  A taxa de variação de $q$ no tempo é $dq/dt$ e é modelada por
  \begin{equation}
    \frac{dq}{dt} = \underbrace{sr}_{\text{taxa de entrada}} - \underbrace{\frac{q}{l}r}_{\text{taxa de saída}}.
  \end{equation}
  Ou seja, o problema é modelado como o seguinte PVI
  \begin{align}
    &\frac{dq}{dt} = sr - \frac{q}{l}r,\quad t>0,\\
    &q(0) = q_0,
  \end{align}
  onde $s$, $r$, $l$ e $q_0$ são parâmetros do problema. A EDO relacionada é linear de primeira ordem e, portanto, pode ser resolvida pelo método dos fatores integrantes. Veja o Exercício Resolvido \ref{exeresol:mistura_em_tanque}.
\end{ex}

\begin{ex}\normalfont{(Objeto em queda livre)}
  Seja $m$~kg a massa de um objeto em queda livre em um meio com resistência de $\gamma$~kg/s e aceleração da gravidade de $g$~m/s$^2$. A segunda lei de Newton é a lei física que estabelece que a força total atuando sobre o objeto é igual a sua massa multiplicada por sua aceleração. Desta forma, obtemos
  \begin{equation}
    \underbrace{m\frac{dv}{dt}}_{\text{massa}\times\text{aceleração}} = \underbrace{mg}_{\text{força da gravidade}} - \underbrace{\gamma v}_{\text{força da resistência}]},
  \end{equation}
  onde $v = v(t)$~m/s é a velocidade do objeto (sentido positivo igual ao da força da gravidade). Assumindo que o objeto tem velocidade $v_0$~m/s no instante inicial $t=0$, o modelo resume-se ao seguinte PVI:
  \begin{align}
    &m\frac{dv}{dt} = mg - \gamma v,\quad t>0, \\
    &v(0) = v_0,
  \end{align}
  onde $m$, $g$, $\gamma$ e $v_0$ são parâmetros.
\end{ex}

\subsection*{Exercícios resolvidos}

\begin{exeresol}
  Resolva o seguinte PVI
  \begin{align}
    &y' + y = 1, \quad t>0,\\
    &y(0) = 2.
  \end{align}
\end{exeresol}
\begin{resol}
  Primeiramente, obtemos a solução geral da EDO pelo método dos fatores integrante. Para tanto, buscamos pelo fator integrante $\mu$ tal que
  \begin{equation}
    \mu y' + \mu y = (\mu y)',
  \end{equation}
  ou seja,
  \begin{equation}
    \mu' = \mu \Rightarrow \mu(t) = e^{t}.
  \end{equation}
  Obtido o fator integrante, reescrevemos a EDO como segue
  \begin{equation}
    \frac{d}{dt}\left(\mu y\right) = \mu\cdot 1 \Rightarrow \frac{d}{dt}\left(e^ty\right) = e^t.
  \end{equation}
  Integrando, obtemos a solução geral
  \begin{equation}
    y = 1 + ce^{-t}.
  \end{equation}

  Aplicando a condição inicial, obtemos
  \begin{align}
    y(0) = 2 &\Rightarrow 1 + ce^{-0} = 2 \\
             &\Rightarrow c = 1.
  \end{align}

  Concluímos que a solução do PVI é $y(t) = 1 + e^{-t}$.
\end{resol}

\begin{exeresol}
  Calcule a solução geral da EDO
  \begin{align}
    y' + \frac{1}{t}y = \sen(t),\quad t>0.
  \end{align}
\end{exeresol}
\begin{resol}
  Buscamos pelo fator integrante $\mu$ tal que
  \begin{equation}
    \mu y' + \mu \frac{1}{t}y = (\mu y)',
  \end{equation}
  ou seja,
  \begin{equation}
    \mu' = \frac{\mu}{t} \Rightarrow \mu(t) = e^{\int \frac{1}{t}\,dt} = e^{\ln|t|} = t.
  \end{equation}
  Obtido o fator integrante, reescrevemos a EDO como segue
  \begin{equation}
    \frac{d}{dt}\left(\mu y\right) = \mu\cdot \sen(t) \Rightarrow \frac{d}{dt}\left(t y\right) = t\sen(t).
  \end{equation}
  Integrando, obtemos a solução geral
  \begin{equation}
    y(t) = \frac{c}{t}  + \frac{\sen(t)}{t} - \cos(t).
  \end{equation}
\end{resol}

\begin{exeresol}(Mistura em tanque)
  No instante inicial $t=0$~s (segundo), um tanque contem $100$~kg de sal dissolvidos em $1000$~L d'água. Uma solução de $0,2$~kg/L de sal e água entra no tanque a uma taxa de $10$~L/s. Esta solução mistura-se com o líquido presente no tanque e a mistura final sai do tanque a mesma taxa de $10$~L/s. Calcule a quantidade de sal misturado no tanque após $1$ hora de operação, i.e. quando $t=3600$~s.
\end{exeresol}
\begin{resol}
  Denotando por $q = q(t)$~kg a quantidade de sal misturado no tanque no instante $t$, temos que a taxa de variação de $q$ no tempo é dada por
  \begin{align}
    \frac{dq}{dt} &= 0,2\cdot 10 - \frac{q}{1000}\cdot 10 \\
                  &= 2 - \frac{q}{100}.
  \end{align}
  Ou seja, o modelo constitui-se no seguinte PVI
  \begin{align}
    \frac{dq}{dt} = 2 - \frac{q}{100},\quad t>0,\label{eq:exeresol_mistura_edo}\\
    q(0) = 100.
  \end{align}

  Para resolver o problema, vamos usar o método dos fatores integrantes. O fator integrante é escolhido como sendo
  \begin{align}
    \mu(t) &= e^{\int \frac{1}{100}\,dt} \\
           &= e^{t/100}.
  \end{align}
  Segue que a EDO \eqref{eq:exeresol_mistura_edo} pode ser reescrita como
  \begin{equation}
    \frac{d}{dt}\left(qe^{t/100}\right) = 2e^{t/100}.
  \end{equation}
  Integrando, obtemos
  \begin{align}
    q(t) &= e^{-t/100}\int 2e^{t/100}\,dt \\
         &= e^{-t/100}\left(200e^{t/100} + c\right) \\
         &= 200 + ce^{-t/100}.
  \end{align}
  Da condição inicial, obtemos
  \begin{align}
    q(0) = 100 &\Rightarrow 200 + c = 100 \\
               &\Rightarrow c = -100.
  \end{align}
  Logo, a solução do PVI é
  \begin{equation}
    q(t) = 200 - 100e^{-t/100}.
  \end{equation}
  No tempo $t=3600$~s, temos
  \begin{equation}
    q(3600) = 200 - 100e^{-3600/100} \approx 200~\text{kg}.
  \end{equation}
\end{resol}

\subsection*{Exercícios}

\begin{exer}
  Calcule a solução do seguinte PVI
  \begin{align}
    &y' + y = 0, \quad t>0, \\
    &y(0) = 1.    
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = e^{-t}$
\end{resp}

\begin{exer}
  Calcule a solução do seguinte PVI
  \begin{align}
    &y' - y = 2, \quad t>0, \\
    &y(0) = 1.    
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = 2 - e^{-t}$
\end{resp}

\begin{exer}
  Calcule a solução geral da seguinte EDO
  \begin{equation}
    y' + y = \sen(t).
  \end{equation}
\end{exer}
\begin{resp}
  $y(t) = ce^{-t} + \frac{\sen(x)}{2} + \frac{\cos(x)}{2}$
\end{resp}

\begin{exer}
  Calcule a solução geral do seguinte PVI
  \begin{align}
    &y' + \frac{1}{t}y = 2t,\quad t>1,\\
    &y(1) = 0.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = -\frac{2}{3}\left(\frac{1}{t} + t^2\right)$
\end{resp}

\begin{exer}
  Calcule a solução geral do seguinte PVI
  \begin{align}
    &ty' + 2y = 1,\quad t>1,\\
    &y(1) = 1.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = -\frac{1}{2}\left(\frac{1}{t^2} + 1\right)$
\end{resp}

\begin{exer}
  Seja um objeto de massa $m = 1$~kg em queda livre sujeito a aceleração da gravidade de $9,8$~m/s$^2$ e resistência do meio de $\gamma = 0,2$~kg/s. Assuma, ainda, que o objeto está em repouso no tempo inicial e a uma altura de $10$~m (metros) do solo. Quanto tempo leva para o objeto atingir o solo.
\end{exer}
\begin{resp}
  $1.5$~s
\end{resp}

